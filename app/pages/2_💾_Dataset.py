import streamlit as st
import pandas as pd


df = pd.read_csv('data/neo_task.csv')
df_upd = pd.read_csv('data/neo_task_upd.csv')

st.set_page_config(page_title='Dataset', page_icon='üíæ')

st.markdown('''
# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö

## –¢–µ–º–∞—Ç–∏–∫–∞
–≠—Ç–æ—Ç –¥–∞—Ç–∞—Å–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏, –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ—Ç–æ—Ä—ã—Ö –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∞—Å—Ç–µ—Ä–æ–∏–¥, 
–∫–æ—Ç–æ—Ä—ã–π —É–∂–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω –∫–∞–∫ –±–ª–∏–∂–∞–π—à–∏–π –∫ –ó–µ–º–ª–µ –æ–±—ä–µ–∫—Ç, –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–ª–∏ –Ω–µ –±—ã—Ç—å –æ–ø–∞—Å–Ω—ã–º.

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- `id` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞—Å—Ç–µ—Ä–æ–∏–¥–∞
- `name` - –∏–º—è, –¥–∞–Ω–Ω–æ–µ –ù–ê–°–ê
- `est_diameter_min` - –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç–Ω—ã–π –¥–∏–∞–º–µ—Ç—Ä –≤ –∫–∏–ª–æ–º–µ—Ç—Ä–∞—Ö
- `est_diameter_max` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç–Ω—ã–π –¥–∏–∞–º–µ—Ç—Ä –≤ –∫–∏–ª–æ–º–µ—Ç—Ä–∞—Ö
- `relative_velocity` - —Å–∫–æ—Ä–æ—Å—Ç—å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ó–µ–º–ª–∏
- `miss_distance` - –ø—Ä–æ–ø—É—â–µ–Ω–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –≤ –∫–∏–ª–æ–º–µ—Ç—Ä–∞—Ö
- `absolute_magnitude` - –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é —è—Ä–∫–æ—Å—Ç—å
- `hazardous` - –ª–æ–≥–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–∑–Ω–∞–∫, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∏–π, –æ–ø–∞—Å–µ–Ω –∞—Å—Ç–µ—Ä–æ–∏–¥ –∏–ª–∏ –Ω–µ—Ç

**–î–∞—Ç–∞—Å–µ—Ç –¥–æ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ üëá**
''')
st.dataframe(df)

st.markdown('''
## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö
- –£–¥–∞–ª–µ–Ω—ã —Å—Ç–æ–ª–±—Ü—ã `id` –∏ `name`
```
df.drop(['id','name'], axis=1, inplace=True)
```
- –ò–∑–º–µ–Ω—ë–Ω —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö —Å—Ç–æ–ª–±—Ü–∞ `hazardous` —Å bool –Ω–∞ int
```
df['hazardous'] = df['hazardous'].astype(int)
```
- –£–¥–∞–ª–µ–Ω—ã —Å—Ç—Ä–æ–∫–∏, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —ç–ª–µ–º–µ–Ω—Ç
```
df.dropna(inplace=True)
```
- –£–¥–∞–ª–µ–Ω—ã –≤—ã–±—Ä–æ—Å—ã –ø—É—Ç–µ–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∏–∂–Ω–µ–≥–æ/–≤–µ—Ä—Ö–Ω–µ–≥–æ –ø—Ä–µ–¥–µ–ª–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –∑–Ω–∞—á–µ–Ω–∏–π
```
iX = iX = df.drop(['hazardous'], axis=1).columns

Q1 = df[iX].quantile(0.25)
Q3 = df[iX].quantile(0.75)
IQR = Q3-Q1
lower = Q1 - 1.5 * IQR
upper = Q3 + 1.5 * IQR

df[iX] = np.clip(df[iX], lower, upper, axis=1)
```

**–î–∞—Ç–∞—Å–µ—Ç –ø–æ—Å–ª–µ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ üëá**
''')
st.dataframe(df_upd)
